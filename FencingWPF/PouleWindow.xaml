<Window x:Class="FencingWPF.PouleWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Poule" Height="500" Width="900"
        WindowStartupLocation="CenterScreen">

    <!-- ✅ All templates and brushes must go inside Resources -->
    <Window.Resources>
        <DataTemplate x:Key="PlayerHeaderTemplate">
            <TextBlock Text="{Binding Player.FullName}" FontWeight="Bold"/>
        </DataTemplate>
    </Window.Resources>

    <!-- ✅ The window can have only ONE content element, here it's DockPanel -->
    <DockPanel Margin="10">

        <!-- Top controls -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="10">
            <ComboBox x:Name="cbWinner" Width="150" SelectionChanged="ComboBoxPlayer_SelectionChanged">
                <ComboBox.ItemContainerStyle>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="HorizontalAlignment" Value="Stretch"/>
                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                        <Setter Property="IsEnabled" Value="{Binding IsEnabled}"/>
                        <Setter Property="Foreground" Value="Black"/>
                        <Style.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="Gray"/>
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </ComboBox.ItemContainerStyle>
            </ComboBox>

            <ComboBox x:Name="cbScoreWinner" Width="60" SelectionChanged="ComboBoxScore_SelectionChanged"/>
            <ComboBox x:Name="cbScoreLoser" Width="60" SelectionChanged="ComboBoxScore_SelectionChanged"/>

            <ComboBox x:Name="cbLoser" Width="150" SelectionChanged="ComboBoxPlayer_SelectionChanged">
                <ComboBox.ItemContainerStyle>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="HorizontalAlignment" Value="Stretch"/>
                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                        <Setter Property="IsEnabled" Value="{Binding IsEnabled}"/>
                        <Setter Property="Foreground" Value="Black"/>
                        <Style.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="Gray"/>
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </ComboBox.ItemContainerStyle>
            </ComboBox>
            
            <Button Content="Add Match" Width="120" Height="32" Click="btnAddMatch_Click"/>
            <Button Content="Export CSV" Width="120" Height="32" Margin="10,0,0,0" Click="btnExportCsv_Click" Background="#FF2EB65E"/>
            <Button Content="Show Final Results" Width="150" Height="32" Margin="10,0,0,0" Click="btnShowResults_Click"/>
        </StackPanel>

        <!-- Data grid -->
        <DataGrid x:Name="dgPoule"
                  AutoGenerateColumns="False"
                  HeadersVisibility="All"
                  IsReadOnly="False"
                  RowHeaderWidth="150"
                  Margin="0,10,0,0"
                  CanUserResizeRows="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserSortColumns="False"
                  CanUserReorderColumns="False" SelectionUnit="Cell" SelectionMode="Single">
            
            <DataGrid.RowHeaderStyle>
                <Style TargetType="DataGridRowHeader">
                    <Setter Property="Content" Value="{Binding Player.DisplayName}"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                    <Setter Property="Padding" Value="4"/>
                </Style>
            </DataGrid.RowHeaderStyle>

        </DataGrid>

    </DockPanel>
</Window>
